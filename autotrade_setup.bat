@echo off
setlocal enabledelayedexpansion

REM ====================================
REM  AutoTrade - ì˜¬ì¸ì› ì„¤ì¹˜ ë° ì‹¤í–‰
REM ====================================

:MAIN_MENU
cls
echo.
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                                                                    â•‘
echo â•‘              ðŸš€ AutoTrade ì˜¬ì¸ì› ì„¤ì¹˜ ë° ì‹¤í–‰ ë„êµ¬                â•‘
echo â•‘                                                                    â•‘
echo â•‘             í‚¤ì›€ OpenAPI 32ë¹„íŠ¸ í™˜ê²½ ìžë™ ì„¤ì •                    â•‘
echo â•‘                                                                    â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

REM í˜„ìž¬ í™˜ê²½ í™•ì¸
call :CHECK_ENVIRONMENT

echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo  ðŸ“‹ ë©”ë‰´
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo   [1] ðŸ”§ ì „ì²´ ì„¤ì¹˜ (32ë¹„íŠ¸ í™˜ê²½ ìƒì„± + íŒ¨í‚¤ì§€ ì„¤ì¹˜)
echo   [2] ðŸ“¦ íŒ¨í‚¤ì§€ë§Œ ì„¤ì¹˜ (í™˜ê²½ì´ ì´ë¯¸ ìžˆëŠ” ê²½ìš°)
echo   [3] ðŸ§ª ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
echo   [4] ðŸš€ ë©”ì¸ í”„ë¡œê·¸ëž¨ ì‹¤í–‰
echo   [5] â„¹ï¸  í™˜ê²½ ì •ë³´ í™•ì¸
echo   [6] ðŸ—‘ï¸  í™˜ê²½ ì œê±° í›„ ìž¬ì„¤ì¹˜
echo   [0] âŒ ì¢…ë£Œ
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

set /p CHOICE="ì„ íƒí•˜ì„¸ìš” (0-6): "

if "%CHOICE%"=="1" goto FULL_INSTALL
if "%CHOICE%"=="2" goto INSTALL_PACKAGES
if "%CHOICE%"=="3" goto TEST_LOGIN
if "%CHOICE%"=="4" goto RUN_MAIN
if "%CHOICE%"=="5" goto SHOW_INFO
if "%CHOICE%"=="6" goto REMOVE_ENV
if "%CHOICE%"=="0" goto EXIT
goto MAIN_MENU

REM ====================================
REM í™˜ê²½ í™•ì¸
REM ====================================
:CHECK_ENVIRONMENT
where conda >nul 2>&1
if %errorLevel% neq 0 (
    set CONDA_INSTALLED=âŒ
) else (
    set CONDA_INSTALLED=âœ…
)

conda env list 2>nul | find "autotrade_32" >nul 2>&1
if %errorLevel% neq 0 (
    set ENV_EXISTS=âŒ
) else (
    set ENV_EXISTS=âœ…
)

echo ðŸ“Š í˜„ìž¬ ìƒíƒœ:
echo    Anaconda: %CONDA_INSTALLED%
echo    autotrade_32 í™˜ê²½: %ENV_EXISTS%

if "%ENV_EXISTS%"=="âœ…" (
    call conda activate autotrade_32 2>nul
    python -c "import struct; bits = struct.calcsize('P') * 8; print('   Python ë¹„íŠ¸:', bits, 'bit')" 2>nul
)

goto :EOF

REM ====================================
REM 1. ì „ì²´ ì„¤ì¹˜
REM ====================================
:FULL_INSTALL
cls
echo.
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                                                                    â•‘
echo â•‘                  ðŸ”§ ì „ì²´ ì„¤ì¹˜ ì‹œìž‘                                â•‘
echo â•‘                                                                    â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

REM Conda í™•ì¸
where conda >nul 2>&1
if %errorLevel% neq 0 (
    echo âŒ Anacondaê°€ ì„¤ì¹˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤!
    echo.
    echo ðŸ’¡ Anacondaë¥¼ ë¨¼ì € ì„¤ì¹˜í•˜ì„¸ìš”:
    echo    https://www.anaconda.com/download
    echo.
    pause
    goto MAIN_MENU
)

echo âœ… Anaconda í™•ì¸ ì™„ë£Œ
echo.

REM ê¸°ì¡´ í™˜ê²½ í™•ì¸
conda env list | find "autotrade_32" >nul 2>&1
if %errorLevel% equ 0 (
    echo âš ï¸  autotrade_32 í™˜ê²½ì´ ì´ë¯¸ ì¡´ìž¬í•©ë‹ˆë‹¤.
    echo.
    set /p REMOVE="ì‚­ì œí•˜ê³  ìž¬ì„¤ì¹˜í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (y/n): "
    if /i "!REMOVE!"=="y" (
        call :REMOVE_ENVIRONMENT
    ) else (
        echo.
        echo ê¸°ì¡´ í™˜ê²½ì„ ìœ ì§€í•©ë‹ˆë‹¤. íŒ¨í‚¤ì§€ ì„¤ì¹˜ë¡œ ì´ë™í•©ë‹ˆë‹¤.
        timeout /t 2 >nul
        goto INSTALL_PACKAGES
    )
)

echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo  Step 1/5: 32ë¹„íŠ¸ Python í™˜ê²½ ìƒì„±
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

set CONDA_FORCE_32BIT=1
echo 32ë¹„íŠ¸ Python 3.11 í™˜ê²½ì„ ìƒì„± ì¤‘ìž…ë‹ˆë‹¤...
echo (ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìžˆìŠµë‹ˆë‹¤)
echo.

conda create -n autotrade_32 python=3.11 -y

if %errorLevel% neq 0 (
    echo.
    echo âŒ í™˜ê²½ ìƒì„± ì‹¤íŒ¨!
    pause
    goto MAIN_MENU
)

echo.
echo âœ… í™˜ê²½ ìƒì„± ì™„ë£Œ
timeout /t 2 >nul

REM íŒ¨í‚¤ì§€ ì„¤ì¹˜ë¡œ ì´ë™
goto INSTALL_PACKAGES

REM ====================================
REM 2. íŒ¨í‚¤ì§€ ì„¤ì¹˜
REM ====================================
:INSTALL_PACKAGES
cls
echo.
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                                                                    â•‘
echo â•‘                  ðŸ“¦ íŒ¨í‚¤ì§€ ì„¤ì¹˜                                   â•‘
echo â•‘                                                                    â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

REM í™˜ê²½ í™œì„±í™”
call conda activate autotrade_32

if %errorLevel% neq 0 (
    echo âŒ autotrade_32 í™˜ê²½ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!
    echo.
    echo ðŸ’¡ ë¨¼ì € "ì „ì²´ ì„¤ì¹˜"ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”.
    pause
    goto MAIN_MENU
)

echo âœ… autotrade_32 í™˜ê²½ í™œì„±í™”
echo.

REM ë¹„íŠ¸ í™•ì¸
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo  Step 2/5: Python ë¹„íŠ¸ í™•ì¸
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

python -c "import struct; bits = struct.calcsize('P') * 8; print(f'Python: {bits}-bit'); exit(0 if bits == 32 else 1)"

if %errorLevel% neq 0 (
    echo.
    echo âŒ 32ë¹„íŠ¸ í™˜ê²½ì´ ì•„ë‹™ë‹ˆë‹¤!
    echo.
    echo ðŸ’¡ í•´ê²°ì±…:
    echo    1. í™˜ê²½ì„ ì‚­ì œí•˜ê³  ë‹¤ì‹œ ìƒì„± (ë©”ë‰´ [6])
    echo    2. ë˜ëŠ” 32ë¹„íŠ¸ Pythonì„ ì§ì ‘ ì„¤ì¹˜
    echo       https://www.python.org/downloads/
    pause
    goto MAIN_MENU
)

echo.

REM pip ì—…ê·¸ë ˆì´ë“œ
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo  Step 3/5: pip ì—…ê·¸ë ˆì´ë“œ
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

python -m pip install --upgrade pip --quiet

echo âœ… pip ì—…ê·¸ë ˆì´ë“œ ì™„ë£Œ
echo.

REM í•µì‹¬ íŒ¨í‚¤ì§€ ì„¤ì¹˜
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo  Step 4/5: í•µì‹¬ íŒ¨í‚¤ì§€ ì„¤ì¹˜
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

echo [1/4] PyQt5 ì„¤ì¹˜ ì¤‘...
pip install PyQt5 PyQt5-Qt5 PyQt5-sip --quiet --no-warn-script-location

if %errorLevel% neq 0 (
    echo âŒ PyQt5 ì„¤ì¹˜ ì‹¤íŒ¨
    pause
    goto MAIN_MENU
)
echo âœ… PyQt5 ì„¤ì¹˜ ì™„ë£Œ

echo.
echo [2/4] koapy ì˜ì¡´ì„± ì„¤ì¹˜ ì¤‘...
pip install protobuf==3.20.3 grpcio==1.50.0 --quiet --no-warn-script-location
echo âœ… protobuf, grpcio ì„¤ì¹˜ ì™„ë£Œ

echo.
echo [3/4] koapy ì„¤ì¹˜ ì¤‘...
pip install koapy --quiet --no-warn-script-location
echo âœ… koapy ì„¤ì¹˜ ì™„ë£Œ

echo.
echo [4/4] pywin32 ì„¤ì¹˜ ì¤‘...
pip install pywin32 --quiet --no-warn-script-location
echo âœ… pywin32 ì„¤ì¹˜ ì™„ë£Œ

echo.

REM ì „ì²´ íŒ¨í‚¤ì§€ ì„¤ì¹˜
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo  Step 5/5: ë‚˜ë¨¸ì§€ íŒ¨í‚¤ì§€ ì„¤ì¹˜
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

echo ì „ì²´ requirements.txt íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤...
echo (ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìžˆìŠµë‹ˆë‹¤)
echo.

pip install -r requirements.txt --quiet --no-warn-script-location

if %errorLevel% neq 0 (
    echo.
    echo âš ï¸  ì¼ë¶€ íŒ¨í‚¤ì§€ ì„¤ì¹˜ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.
    echo     í•˜ì§€ë§Œ í•µì‹¬ íŒ¨í‚¤ì§€ëŠ” ì„¤ì¹˜ë˜ì—ˆìœ¼ë¯€ë¡œ ê³„ì† ì§„í–‰í•©ë‹ˆë‹¤.
)

echo.
echo âœ… íŒ¨í‚¤ì§€ ì„¤ì¹˜ ì™„ë£Œ
echo.

REM ì„¤ì¹˜ í™•ì¸
call :VERIFY_INSTALLATION

echo.
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                                                                    â•‘
echo â•‘              âœ… ì„¤ì¹˜ ì™„ë£Œ!                                        â•‘
echo â•‘                                                                    â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo ðŸ’¡ ì´ì œ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?
echo.
set /p RUN_TEST="ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸ ì‹¤í–‰? (y/n): "

if /i "%RUN_TEST%"=="y" (
    goto TEST_LOGIN
)

pause
goto MAIN_MENU

REM ====================================
REM 3. ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸
REM ====================================
:TEST_LOGIN
cls
echo.
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                                                                    â•‘
echo â•‘                  ðŸ§ª ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸                                 â•‘
echo â•‘                                                                    â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

REM í™˜ê²½ í™œì„±í™”
call conda activate autotrade_32 2>nul

if %errorLevel% neq 0 (
    echo âŒ autotrade_32 í™˜ê²½ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!
    echo.
    echo ðŸ’¡ ë¨¼ì € ì„¤ì¹˜ë¥¼ ì§„í–‰í•˜ì„¸ìš” (ë©”ë‰´ [1])
    pause
    goto MAIN_MENU
)

REM test_login.py ì¡´ìž¬ í™•ì¸
if not exist "test_login.py" (
    echo âŒ test_login.py íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!
    echo.
    echo í˜„ìž¬ ë””ë ‰í† ë¦¬: %CD%
    pause
    goto MAIN_MENU
)

echo ðŸš€ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸ë¥¼ ì‹œìž‘í•©ë‹ˆë‹¤...
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

python test_login.py

echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo  í…ŒìŠ¤íŠ¸ ì™„ë£Œ
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

pause
goto MAIN_MENU

REM ====================================
REM 4. ë©”ì¸ í”„ë¡œê·¸ëž¨ ì‹¤í–‰
REM ====================================
:RUN_MAIN
cls
echo.
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                                                                    â•‘
echo â•‘                  ðŸš€ ë©”ì¸ í”„ë¡œê·¸ëž¨ ì‹¤í–‰                            â•‘
echo â•‘                                                                    â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

REM í™˜ê²½ í™œì„±í™”
call conda activate autotrade_32 2>nul

if %errorLevel% neq 0 (
    echo âŒ autotrade_32 í™˜ê²½ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!
    echo.
    echo ðŸ’¡ ë¨¼ì € ì„¤ì¹˜ë¥¼ ì§„í–‰í•˜ì„¸ìš” (ë©”ë‰´ [1])
    pause
    goto MAIN_MENU
)

REM main.py ì¡´ìž¬ í™•ì¸
if not exist "main.py" (
    echo âŒ main.py íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!
    echo.
    echo í˜„ìž¬ ë””ë ‰í† ë¦¬: %CD%
    pause
    goto MAIN_MENU
)

echo ðŸš€ AutoTrade ë©”ì¸ í”„ë¡œê·¸ëž¨ì„ ì‹œìž‘í•©ë‹ˆë‹¤...
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

python main.py

echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo  í”„ë¡œê·¸ëž¨ ì¢…ë£Œ
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

pause
goto MAIN_MENU

REM ====================================
REM 5. í™˜ê²½ ì •ë³´ í™•ì¸
REM ====================================
:SHOW_INFO
cls
echo.
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                                                                    â•‘
echo â•‘                  â„¹ï¸  í™˜ê²½ ì •ë³´                                    â•‘
echo â•‘                                                                    â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

REM Anaconda í™•ì¸
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo  Anaconda ì •ë³´
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

where conda >nul 2>&1
if %errorLevel% neq 0 (
    echo âŒ Anacondaê°€ ì„¤ì¹˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤
) else (
    echo âœ… Anaconda ì„¤ì¹˜ë¨
    conda --version 2>nul
)

echo.

REM í™˜ê²½ ëª©ë¡
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo  Conda í™˜ê²½ ëª©ë¡
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

conda env list 2>nul

echo.

REM autotrade_32 í™˜ê²½ í™•ì¸
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo  autotrade_32 í™˜ê²½ ìƒì„¸ ì •ë³´
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

conda env list | find "autotrade_32" >nul 2>&1
if %errorLevel% neq 0 (
    echo âŒ autotrade_32 í™˜ê²½ì´ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤
) else (
    echo âœ… autotrade_32 í™˜ê²½ ì¡´ìž¬
    echo.

    call conda activate autotrade_32 2>nul

    echo Python ë²„ì „:
    python --version 2>nul

    echo.
    echo Python ë¹„íŠ¸:
    python -c "import struct; print(f'{struct.calcsize(\"P\")*8}-bit')" 2>nul

    echo.
    echo ì„¤ì¹˜ëœ í•µì‹¬ íŒ¨í‚¤ì§€:
    call :VERIFY_INSTALLATION
)

echo.
pause
goto MAIN_MENU

REM ====================================
REM 6. í™˜ê²½ ì œê±°
REM ====================================
:REMOVE_ENV
cls
echo.
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                                                                    â•‘
echo â•‘                  ðŸ—‘ï¸  í™˜ê²½ ì œê±°                                    â•‘
echo â•‘                                                                    â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

echo âš ï¸  ê²½ê³ : autotrade_32 í™˜ê²½ì„ ì™„ì „ížˆ ì‚­ì œí•©ë‹ˆë‹¤!
echo.
set /p CONFIRM="ì •ë§ë¡œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? (y/n): "

if /i not "%CONFIRM%"=="y" (
    echo.
    echo ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.
    timeout /t 2 >nul
    goto MAIN_MENU
)

call :REMOVE_ENVIRONMENT

set /p REINSTALL="ìƒˆë¡œ ì„¤ì¹˜í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (y/n): "

if /i "%REINSTALL%"=="y" (
    goto FULL_INSTALL
)

pause
goto MAIN_MENU

REM ====================================
REM í™˜ê²½ ì œê±° í•¨ìˆ˜
REM ====================================
:REMOVE_ENVIRONMENT
echo.
echo ðŸ—‘ï¸  autotrade_32 í™˜ê²½ ì œê±° ì¤‘...

call conda deactivate 2>nul
conda env remove -n autotrade_32 -y

if %errorLevel% equ 0 (
    echo âœ… í™˜ê²½ ì œê±° ì™„ë£Œ
) else (
    echo âŒ í™˜ê²½ ì œê±° ì‹¤íŒ¨
)

echo.
timeout /t 2 >nul
goto :EOF

REM ====================================
REM ì„¤ì¹˜ í™•ì¸ í•¨ìˆ˜
REM ====================================
:VERIFY_INSTALLATION
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo  ì„¤ì¹˜ í™•ì¸
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

python -c "from PyQt5.QtWidgets import QApplication; print('âœ… PyQt5')" 2>nul
if %errorLevel% neq 0 echo âŒ PyQt5

python -c "from koapy import KiwoomOpenApiPlusEntrypoint; print('âœ… koapy')" 2>nul
if %errorLevel% neq 0 echo âŒ koapy

python -c "from pydantic import BaseModel; print('âœ… pydantic')" 2>nul
if %errorLevel% neq 0 echo âŒ pydantic

python -c "import pandas; print('âœ… pandas')" 2>nul
if %errorLevel% neq 0 echo âŒ pandas

python -c "import numpy; print('âœ… numpy')" 2>nul
if %errorLevel% neq 0 echo âŒ numpy

python -c "import pywin32_system32; print('âœ… pywin32')" 2>nul
if %errorLevel% neq 0 echo âŒ pywin32

goto :EOF

REM ====================================
REM ì¢…ë£Œ
REM ====================================
:EXIT
cls
echo.
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                                                                    â•‘
echo â•‘            ðŸ‘‹ AutoTrade ì„¤ì • ë„êµ¬ë¥¼ ì¢…ë£Œí•©ë‹ˆë‹¤                    â•‘
echo â•‘                                                                    â•‘
echo â•‘                   Happy Trading! ðŸš€ðŸ“ˆ                             â•‘
echo â•‘                                                                    â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
timeout /t 2 >nul
exit /b 0
