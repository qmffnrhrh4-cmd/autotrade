# Manual Tests

ìŠ¤ì½”ì–´ë§ ì‹œìŠ¤í…œ ë° WebSocket ì—°ê²°ì„ ìœ„í•œ ì¢…í•© í…ŒìŠ¤íŠ¸ ìŠ¤ìœ„íŠ¸

## ğŸ“‹ í…ŒìŠ¤íŠ¸ íŒŒì¼

### 1. test_comprehensive_data_collection.py
**ì¢…í•© API í…ŒìŠ¤íŠ¸ - ëª¨ë“  ìŠ¤ì½”ì–´ë§ ë°ì´í„° ìˆ˜ì§‘ ê²€ì¦**

```bash
python tests/manual_tests/test_comprehensive_data_collection.py
```

**í…ŒìŠ¤íŠ¸ í•­ëª©:**
- âœ… 13ê°œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ (40+ API ì¡°í•©)
- Part 1: ìŠ¤ì½”ì–´ë§ API í…ŒìŠ¤íŠ¸
- Part 2: WebSocket ì—°ê²° í…ŒìŠ¤íŠ¸

**ê²€ì¦ ì™„ë£Œëœ API:**
| API ID | ì´ë¦„ | ê²½ë¡œ | ìš©ë„ |
|--------|------|------|------|
| ka10081 | ì¼ë´‰ì°¨íŠ¸ì¡°íšŒ | chart | í‰ê· ê±°ë˜ëŸ‰, ë³€ë™ì„± |
| ka10047 | ì²´ê²°ê°•ë„ì¶”ì´ | mrkcond | ì²´ê²°ê°•ë„ |
| ka90013 | í”„ë¡œê·¸ë¨ë§¤ë§¤ì¶”ì´ | mrkcond | í”„ë¡œê·¸ë¨ìˆœë§¤ìˆ˜ |
| ka10078 | ì¦ê¶Œì‚¬ë³„ë§¤ë§¤ë™í–¥ | mrkcond | ì¦ê¶Œì‚¬ ìˆœë§¤ìˆ˜ |
| ka10045 | ê¸°ê´€ë§¤ë§¤ì¶”ì´ | mrkcond | ê¸°ê´€ íŠ¸ë Œë“œ |
| ka10059 | íˆ¬ììë³„ë§¤ë§¤ | stkinfo | ê¸°ê´€/ì™¸êµ­ì¸ ìˆœë§¤ìˆ˜ |
| ka10004 | ì£¼ì‹í˜¸ê°€ | mrkcond | í˜¸ê°€ë¹„ìœ¨ |

### 2. test_websocket_only.py
**WebSocket ì „ìš© í…ŒìŠ¤íŠ¸ - ì‹¤ì‹œê°„ ë°ì´í„° êµ¬ë… ê²€ì¦**

```bash
python tests/manual_tests/test_websocket_only.py
```

**í…ŒìŠ¤íŠ¸ í•­ëª©:**
- ë¡œê·¸ì¸/ì¸ì¦ íŒ¨í„´ í…ŒìŠ¤íŠ¸
- ë‹¤ì–‘í•œ êµ¬ë… íƒ€ì… í…ŒìŠ¤íŠ¸ (type=00, 0B, 0D, 0A ë“±)
- grp_no, refresh íŒŒë¼ë¯¸í„° ì¡°í•©
- ë³µìˆ˜ ì¢…ëª© êµ¬ë… í…ŒìŠ¤íŠ¸

**ê²€ì¦ëœ êµ¬ë… íƒ€ì…:**
| Type | ì´ë¦„ | ìš©ë„ |
|------|------|------|
| 00 | ì£¼ë¬¸ì²´ê²° | ë‚´ ì£¼ë¬¸ ì²´ê²° ì •ë³´ |
| 0B | ì£¼ì‹ì²´ê²° | ì‹¤ì‹œê°„ ì¢…ëª© ì²´ê²°ê°€ |
| 0D | ì£¼ì‹í˜¸ê°€ | ì‹¤ì‹œê°„ í˜¸ê°€ ì •ë³´ |
| 0A | ì£¼ì‹ê¸°ì„¸ | ì²´ê²°ê°•ë„, ì‹œì„¸ ì •ë³´ |

### 3. test_data_collection_comprehensive.py (ë£¨íŠ¸)
**ë¹ ë¥¸ ë°ì´í„° ìˆ˜ì§‘ í…ŒìŠ¤íŠ¸ - 4ê°€ì§€ í•µì‹¬ ë°ì´í„° ì†ŒìŠ¤**

```bash
python test_data_collection_comprehensive.py
```

**í…ŒìŠ¤íŠ¸ í•­ëª©:**
1. í‰ê· ê±°ë˜ëŸ‰ & ë³€ë™ì„± (ka10081)
2. ì¦ê¶Œì‚¬ë³„ ë§¤ë§¤ (ka10078 - ì£¼ìš” 5ê°œ ì¦ê¶Œì‚¬)
3. ì²´ê²°ê°•ë„ (ka10047)
4. í”„ë¡œê·¸ë¨ë§¤ë§¤ (ka90013)

**íŠ¹ì§•:**
- âš¡ ë¹ ë¥¸ ì‹¤í–‰ (1-2ë¶„)
- ğŸ”„ Fallback ë°©ì‹ ì§€ì›
- ğŸ“Š ì‹¤ì‹œê°„ ì„±ê³µë¥  í‘œì‹œ
- ğŸ’¡ ì½”ë“œ ì ìš© ê°€ì´ë“œ ìë™ ìƒì„±

## ğŸ¯ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: ëª¨ë“  API ê²€ì¦
```bash
# ì „ì²´ API í…ŒìŠ¤íŠ¸ (10-15ë¶„ ì†Œìš”)
python tests/manual_tests/test_comprehensive_data_collection.py
```

### ì‹œë‚˜ë¦¬ì˜¤ 2: WebSocketë§Œ í…ŒìŠ¤íŠ¸
```bash
# WebSocket êµ¬ë… íŒ¨í„´ë§Œ í…ŒìŠ¤íŠ¸ (5-10ë¶„ ì†Œìš”)
python tests/manual_tests/test_websocket_only.py
```

### ì‹œë‚˜ë¦¬ì˜¤ 3: ë¹ ë¥¸ ê²€ì¦
```bash
# í•µì‹¬ 4ê°€ì§€ë§Œ ë¹ ë¥´ê²Œ í…ŒìŠ¤íŠ¸ (1-2ë¶„ ì†Œìš”)
python test_data_collection_comprehensive.py
```

## ğŸ“Š ê²°ê³¼ í™•ì¸

ëª¨ë“  í…ŒìŠ¤íŠ¸ ê²°ê³¼ëŠ” `_test_results/` ë””ë ‰í† ë¦¬ì— JSON í˜•ì‹ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤:

```
_test_results/
â”œâ”€â”€ comprehensive_test_20251103_220000.json
â”œâ”€â”€ websocket_test_20251103_221000.json
â””â”€â”€ ...
```

**JSON êµ¬ì¡°:**
```json
{
  "timestamp": "20251103_220000",
  "scoring_apis": [
    {
      "test_name": "Case 11-1: ì¼ë´‰ì°¨íŠ¸ì¡°íšŒ",
      "api_id": "ka10081",
      "success": true,
      "return_code": 0,
      "has_data": true,
      "sample_data": {...}
    }
  ],
  "websocket_tests": [...]
}
```

## âœ… ì„±ê³µ ê¸°ì¤€

### API í…ŒìŠ¤íŠ¸
- âœ… return_code == 0
- âœ… ë°ì´í„° í‚¤ ì¡´ì¬
- âœ… ìƒ˜í”Œ ë°ì´í„° íŒŒì‹± ê°€ëŠ¥

### WebSocket í…ŒìŠ¤íŠ¸
- âœ… ì—°ê²° ì„±ê³µ (connected)
- âœ… êµ¬ë… ì‘ë‹µ ìˆ˜ì‹  (subscription_success)
- âœ… ì‹¤ì‹œê°„ ë©”ì‹œì§€ ìˆ˜ì‹  (messages_received > 0)

## ğŸ”§ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### API í˜¸ì¶œ ì‹¤íŒ¨
```
âŒ ì‹¤íŒ¨: ì˜ëª»ëœ ìš”ì²­ì…ë‹ˆë‹¤[1504:í•´ë‹¹ URIì—ì„œëŠ” ì§€ì›í•˜ëŠ” API IDê°€ ì•„ë‹™ë‹ˆë‹¤]
```
â†’ **í•´ê²°:** path íŒŒë¼ë¯¸í„° í™•ì¸ (chart vs mrkcond vs stkinfo)

### WebSocket ì—°ê²° ì‹¤íŒ¨
```
âŒ ì‹¤íŒ¨: Connection refused
```
â†’ **í•´ê²°:**
1. í† í° ìœ íš¨ì„± í™•ì¸
2. WebSocket URL í™•ì¸ (wss://api.kiwoom.com:10000/api/dostk/websocket)
3. ë°©í™”ë²½ ì„¤ì • í™•ì¸

### ë°ì´í„° ì—†ìŒ
```
âš ï¸ ë°ì´í„° ì—†ìŒ (ë¹„ê±°ë˜ ì‹œê°„ì¼ ìˆ˜ ìˆìŒ)
```
â†’ **í•´ê²°:** ì¥ì¤‘(09:00-15:30)ì— í…ŒìŠ¤íŠ¸ ì‹¤í–‰

## ğŸ“š ì°¸ê³  ìë£Œ

- **API ë¬¸ì„œ:** `_immutable/api_specs/successful_apis.json`
- **ì½”ë“œ:**
  - `api/market.py` - API í˜¸ì¶œ ë©”ì„œë“œ
  - `research/scan_strategies.py` - Deep Scan êµ¬í˜„
  - `strategy/scoring_system.py` - ìŠ¤ì½”ì–´ë§ ë¡œì§
